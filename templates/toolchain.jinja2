# Toolchain: {{ display_name }}
set(CMAKE_SYSTEM_NAME Generic)
set(CMAKE_SYSTEM_PROCESSOR {{ processor }})

# Bare-metal: avoid full executable link in compiler checks (no syscall stubs)
set(CMAKE_TRY_COMPILE_TARGET_TYPE STATIC_LIBRARY)

set(CMAKE_C_COMPILER "{{ compiler.c }}")
set(CMAKE_CXX_COMPILER "{{ compiler.cxx }}")
set(CMAKE_ASM_COMPILER "{{ compiler.asm }}")

{% if flags.c %}
set(CMAKE_C_FLAGS "{% for f in flags.c %}{{ f }} {% endfor %}")
{% endif %}
{% if flags.cxx %}
set(CMAKE_CXX_FLAGS "{% for f in flags.cxx %}{{ f }} {% endfor %}")
{% endif %}
{% if flags.asm %}
set(CMAKE_ASM_FLAGS "{% for f in flags.asm %}{{ f }} {% endfor %}")
{% endif %}
{% if flags.linker %}
set(CMAKE_EXE_LINKER_FLAGS "{% for f in flags.linker %}{{ f }} {% endfor %}")
{% endif %}

{% if sysroot %}
set(CMAKE_SYSROOT "{{ sysroot }}")
set(CMAKE_FIND_ROOT_PATH "{{ sysroot }}")
{% endif %}

{% if defines %}
add_compile_definitions({% for d in defines %} {{ d }}{% endfor %})
{% endif %}

{% if lib_paths %}
set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS}{% for lp in lib_paths %} -L{{ lp }}{% endfor %}")
{% endif %}
{% if libs %}
set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS}{% for lib in libs %} -l{{ lib }}{% endfor %}")
{% endif %}
